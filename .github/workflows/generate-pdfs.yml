name: Generate PDFs

on:
  push:
    branches: [main]
    paths:
      - "Flutter/*.md"
      - "iOS/*.md"
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Generate Flutter PDF
        uses: BaileyJM02/markdown-to-pdf@v1
        with:
          input_path: Flutter/FLUTTER.md
          output_dir: Flutter/
          build_html: false

      - name: Generate iOS PDF
        uses: BaileyJM02/markdown-to-pdf@v1
        with:
          input_path: iOS/iOS.md
          output_dir: iOS/
          build_html: false

      - name: Commit PDFs
        run: |
          git config --local user.email "github-actions[bot]@users.noreply.github.com"
          git config --local user.name "github-actions[bot]"
          git add -A *.pdf
          git diff --staged --quiet || git commit -m "chore: update generated PDFs"
          git push
